var parentFolderId = "#folder_" + "<%= @parent_folder.try(:id) ? @parent_folder.id : '' %>"
var folderId = "#folder_" + "<%= @folder.id %>"
var layer = parseInt(document.getElementsByTagName('body')[0].dataset.layer)
console.log(document.getElementsByTagName('body')[0].dataset.layer)
console.log(layer)

<% if @folder.same_window %>
  $('.foldercontent' + parentFolderId).replaceWith('<%= j render partial: "#{ @folder.partial_name }" %>')
  $('.taskbarItems' + parentFolderId).replaceWith('<%= j render "task_bar_folder" %>')
<% else %>
  if ($('.foldercontent' + folderId).length == 0) {
    $('body').append('<%= j render partial: "#{ @folder.partial_name }" %>')
    $('.taskbar_elements').append('<%= j render "task_bar_folder" %>')
    $('.foldercontent' + folderId).css("z-index", layer)
    document.getElementsByTagName('body')[0].dataset.layer = layer + 1
  }
<% end %>

$(".draggable").draggable({
  zIndex: layer,
  stop: function() {
    document.getElementsByTagName('body')[0].dataset.layer = layer + 1
    $('.foldercontent' + folderId).css("z-index", document.getElementsByTagName('body')[0].dataset.layer)
  }
})

$('.foldercontent' + folderId).on("click", function() {
  $(this).css("z-index", layer)
  document.getElementsByTagName('body')[0].dataset.layer = layer + 1
})
